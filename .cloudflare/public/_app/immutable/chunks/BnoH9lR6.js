const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CGS7vKBx.js","./Cul8aYZn.js","./1yBzCswO.js","./ecJ9cc7E.js","./CYgJF_JY.js"])))=>i.map(i=>d[i]);
var mt=Object.defineProperty;var Je=r=>{throw TypeError(r)};var _t=(r,e,t)=>e in r?mt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var m=(r,e,t)=>_t(r,typeof e!="symbol"?e+"":e,t),Fe=(r,e,t)=>e.has(r)||Je("Cannot "+t);var v=(r,e,t)=>(Fe(r,e,"read from private field"),t?t.call(r):e.get(r)),L=(r,e,t)=>e.has(r)?Je("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),F=(r,e,t,s)=>(Fe(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),P=(r,e,t)=>(Fe(r,e,"access private method"),t);var Ge=(r,e,t,s)=>({set _(i){F(r,e,i,t)},get _(){return v(r,e,s)}});import{g as $e}from"./1yBzCswO.js";import{g as Ye,c as wt,i as vt,R as kt}from"./Cul8aYZn.js";import{_ as St,s as Dt,a as It}from"./Ds6A-agx.js";import{t as at,a as Xe}from"./DKPK2Ygc.js";import{G as Ot,Z as Ft,x as Te,K as te,q as Tt,y as Lt,g as ce,ai as Ct,a9 as Et,aa as Ze,w as Le,z as be,A as Mt,ab as lt,I as ot,ac as At,at as Ce,E as ct,o as Ue,au as Vt,m as Rt,a3 as et,av as Pt,aw as $t,D as Nt,ax as Kt,$ as jt,ay as zt,az as qt,r as Bt,j as xt,V as Ht,R as Qt,Q as Ee,U as tt,T as Wt,S as Jt}from"./ecJ9cc7E.js";import{s as Gt}from"./B0QV6bzL.js";function Yt(r,e){return e}function Xt(r,e,t,s){for(var i=[],n=e.length,a=0;a<n;a++)$t(e[a].e,i,!0);var l=n>0&&i.length===0&&t!==null;if(l){var f=t.parentNode;Nt(f),f.append(t),s.clear(),G(r,e[0].prev,e[n-1].next)}Kt(i,()=>{for(var c=0;c<n;c++){var o=e[c];l||(s.delete(o.k),G(r,o.prev,o.next)),jt(o.e,!l)}})}function Zt(r,e,t,s,i,n=null){var a=r,l={items:new Map,first:null};{var f=r;a=te?Te(Tt(f)):f.appendChild(Ot())}te&&Lt();var c=null,o=!1,d=Ct(()=>{var u=t();return xt(u)?u:u==null?[]:ct(u)});Ft(()=>{var u=ce(d),h=u.length;if(o&&h===0)return;o=h===0;let y=!1;if(te){var p=a.data===Et;p!==(h===0)&&(a=Ze(),Te(a),Le(!1),y=!0)}if(te){for(var w=null,_,b=0;b<h;b++){if(be.nodeType===8&&be.data===Mt){a=be,y=!0,Le(!1);break}var k=u[b],D=s(k,b);_=ft(be,l,w,null,k,D,b,i,e,t),l.items.set(D,_),w=_}h>0&&Te(Ze())}te||Ut(u,l,a,i,e,s,t),n!==null&&(h===0?c?lt(c):c=ot(()=>n(a)):c!==null&&At(c,()=>{c=null})),y&&Le(!0),ce(d)}),te&&(a=be)}function Ut(r,e,t,s,i,n,a){var l=r.length,f=e.items,c=e.first,o=c,d,u=null,h=[],y=[],p,w,_,b;for(b=0;b<l;b+=1){if(p=r[b],w=n(p,b),_=f.get(w),_===void 0){var k=o?o.e.nodes_start:t;u=ft(k,e,u,u===null?e.first:u.next,p,w,b,s,i,a),f.set(w,u),h=[],y=[],o=u.next;continue}if(es(_,p,b),_.e.f&Ce&&lt(_.e),_!==o){if(d!==void 0&&d.has(_)){if(h.length<y.length){var D=y[0],C;u=D.prev;var O=h[0],B=h[h.length-1];for(C=0;C<h.length;C+=1)st(h[C],D,t);for(C=0;C<y.length;C+=1)d.delete(y[C]);G(e,O.prev,B.next),G(e,u,O),G(e,B,D),o=D,u=B,b-=1,h=[],y=[]}else d.delete(_),st(_,o,t),G(e,_.prev,_.next),G(e,_,u===null?e.first:u.next),G(e,u,_),u=_;continue}for(h=[],y=[];o!==null&&o.k!==w;)o.e.f&Ce||(d??(d=new Set)).add(o),y.push(o),o=o.next;if(o===null)continue;_=o}h.push(_),u=_,o=_.next}if(o!==null||d!==void 0){for(var K=d===void 0?[]:ct(d);o!==null;)o.e.f&Ce||K.push(o),o=o.next;var R=K.length;if(R>0){var g=l===0?t:null;Xt(e,K,g,f)}}Ue.first=e.first&&e.first.e,Ue.last=u&&u.e}function es(r,e,t,s){Vt(r.v,e),r.i=t}function ft(r,e,t,s,i,n,a,l,f,c){var o=(f&zt)!==0,d=(f&qt)===0,u=o?d?Rt(i):et(i):i,h=f&Pt?et(a):a,y={i:h,v:u,k:n,a:null,e:null,prev:t,next:s};try{return y.e=ot(()=>l(r,u,h,c),te),y.e.prev=t&&t.e,y.e.next=s&&s.e,t===null?e.first=y:(t.next=y,t.e.next=y.e),s!==null&&(s.prev=y,s.e.prev=y.e),y}finally{}}function st(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,n=r.e.nodes_start;n!==s;){var a=Bt(n);i.before(n),n=a}}function G(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const ts={runtimeDir:".houdini",schemaPath:"src/schema.graphql",plugins:{"houdini-svelte":{forceRunesMode:!0}}},ss=[];var is=ss;function Be(r){return{defaultKeys:["id"],...r,types:{Node:{keys:["id"],resolve:{queryField:"node",arguments:e=>({id:e.id})}},...r.types}}}function ut(r,e){var s,i;const t=Be(r);return((i=(s=t.types)==null?void 0:s[e])==null?void 0:i.keys)||t.defaultKeys}function ns(r,e,t){const s=ut(r,e);let i="";for(const n of s)i+=t[n]+"__";return i.slice(0,-2)}let Me=null;function Gs(r){var e;return((e=r.router)==null?void 0:e.apiEndpoint)??"/_api"}function Se(){if(Me)return Me;let r=Be(ts);for(const e of is)r=e(r);return Me=r,r}function ht(r){const e=[...r.matchAll(/\$HOUDINI\$(\w*\$)?/g)];if(e.length===0)return[r];let t=r.replaceAll(/\$HOUDINI\$(\w*\$)?/g,"%c"),s=[];for(const i of e){const n=i[1]?`color:${i[1].slice(0,-1)}`:"";s.push(n)}return[t,...s]}function rs(r){console.error(...ht(r))}function as(r){console.log(...ht(r))}const U={CacheOrNetwork:"CacheOrNetwork",CacheOnly:"CacheOnly",NetworkOnly:"NetworkOnly",NoCache:"NoCache"},ls={Variables:"Variables"},he={Query:"HoudiniQuery",Subscription:"HoudiniSubscription",Mutation:"HoudiniMutation",Fragment:"HoudiniFragment"},os=he.Query,Ae={Cache:"cache",Network:"network"},xe=" $fragments",cs=Symbol("houdini_loading");let fe=null;async function He(){return fe||(fe=(await St(async()=>{const{default:r}=await import("./CGS7vKBx.js");return{default:r}},__vite__mapDeps([0,1,2,3,4]),import.meta.url)).default,fe)}function it(){if(!fe)throw new Error("client hasn't been initialized");return fe}function Oe(r,e,t=new WeakMap){if(Object.is(r,e))return!0;if(r instanceof Date&&e instanceof Date)return r.getTime()===e.getTime();if(r instanceof RegExp&&e instanceof RegExp)return r.toString()===e.toString();if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.get(r)===e)return!0;t.set(r,e);const s=Reflect.ownKeys(r),i=Reflect.ownKeys(e);if(s.length!==i.length)return!1;for(let n=0;n<s.length;n++)if(!Reflect.has(e,s[n])||!Oe(r[s[n]],e[s[n]],t))return!1;return!0}function H(r,e,t){if(t)return r.loadingTypes&&r.loadingTypes.length>0?dt(...r.loadingTypes.map(i=>{var n;return(n=r.abstractFields)==null?void 0:n.fields[i]})):r.fields??{};let s=r.fields||{};if(r.abstractFields&&e){const i=r.abstractFields.typeMap[e];i?s=r.abstractFields.fields[i]:r.abstractFields.fields[e]&&(s=r.abstractFields.fields[e])}return s}function dt(...r){const e={};for(let t of r)if(t){for(let s in t)if(s in t){const i=t[s];typeof i=="object"&&i!==null&&!Array.isArray(i)?e[s]=dt(e[s]||{},i):e[s]=i}}return e}function nt({selection:r,data:e}){const t=Se();if(e===null||typeof e>"u")return e;if(Array.isArray(e))return e.map(i=>nt({selection:r,data:i}));const s=H(r,e.__typename,!1);return Object.fromEntries(Object.entries(e).map(([i,n])=>{var f;if(i===xe)return[i,n];const{type:a,selection:l}=s[i];if(!a)return[i,n];if(l)return[i,nt({selection:l,data:n})];if((f=t.scalars)!=null&&f[a]){const c=t.scalars[a].marshal;if(!c)throw new Error(`Scalar type ${a} is missing a \`marshal\` function. See https://houdinigraphql.com/api/config#custom-scalars for help on configuring custom scalars.`);return Array.isArray(n)?[i,n.map(c)]:[i,c(n)]}return[i,n]}))}function Ne({artifact:r,input:e,config:t,rootType:s="@root"}){if(e===null||typeof e>"u"||!r.input)return e;const i=s==="@root"?r.input.fields:r.input.types[s];return Array.isArray(e)?e.map(n=>Ne({artifact:r,input:n,rootType:s,config:t})):Object.fromEntries(Object.entries(e).map(([n,a])=>{var c,o;const l=i==null?void 0:i[n];if(!l)return[n,a];const f=(o=(c=t.scalars)==null?void 0:c[l])==null?void 0:o.marshal;return f?Array.isArray(a)?[n,a.map(f)]:[n,f(a)]:fs(t,l)||!r.input.types[l]?[n,a]:[n,Ne({artifact:r,input:a,rootType:l,config:t})]}))}function fs(r,e){return["String","Boolean","Float","ID","Int"].concat(Object.keys(r.scalars||{})).includes(e)}const oe=[],Ve=()=>{};var Q,Y,we;class us{constructor(e,t=Ve){m(this,"state");L(this,Q);L(this,Y);L(this,we);this.state=e,F(this,Q,new Set),F(this,Y,null),F(this,we,t)}set(e){if(hs(this.state,e)&&(this.state=e,v(this,Y))){const t=!oe.length;for(const s of v(this,Q))s[1](),oe.push(s,this.state);if(t){for(let s=0;s<oe.length;s+=2)oe[s][0](oe[s+1]);oe.length=0}}}update(e){this.set(e(this.state))}subscribe(e,t=Ve){const s=[e,t];return v(this,Q).add(s),v(this,Q).size===1&&F(this,Y,v(this,we).call(this,this.set)||Ve),e(this.state),()=>{var i;v(this,Q).delete(s),v(this,Q).size===0&&((i=v(this,Y))==null||i.call(this),F(this,Y,null))}}}Q=new WeakMap,Y=new WeakMap,we=new WeakMap;function hs(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}const pt=({field:r,args:e})=>{const t=Object.keys(e??{});return t.sort(),e&&t.length>0?`${r}(${t.map(s=>`${s}: ${Ke(e[s])}`).join(", ")})`:r},Ke=r=>Array.isArray(r)?`[${r.map(e=>`${Ke(e)}`).join(", ")}]`:typeof r!="object"||r instanceof Date||r===null?JSON.stringify(r).replace(/"([^"]+)":/g,"$1: "):`{${Object.keys(r).map(e=>`${e}: ${Ke(r[e])}`).join(", ")}}`;function J(r){return r?r.reduce((e,t)=>t?Array.isArray(t)?e.concat(J(t)):e.concat(t):e,[]):[]}class ds{constructor(e){m(this,"cache");m(this,"lifetimes",new Map);this.cache=e}get cacheBufferSize(){return this.cache._internal_unstable.config.cacheBufferSize??10}reset(){this.lifetimes.clear()}resetLifetime(e,t){this.lifetimes.get(e)||this.lifetimes.set(e,new Map),this.lifetimes.get(e).set(t,0)}tick(){const e=Date.now().valueOf(),t=this.cache._internal_unstable.config.defaultLifetime;for(const[s,i]of this.lifetimes.entries())for(const[n,a]of i.entries())if(!(this.cache._internal_unstable.subscriptions.get(s,n).length>0)&&(i.set(n,a+1),i.get(n)>this.cacheBufferSize&&(this.cache._internal_unstable.storage.deleteField(s,n),this.cache._internal_unstable.lists.deleteField(s,n),i.delete(n),[...i.keys()].length===0&&this.lifetimes.delete(s),this.cache._internal_unstable.staleManager.delete(s,n)),t&&t>0)){const l=this.cache.getFieldTime(s,n);l&&e-l>t&&this.cache._internal_unstable.staleManager.markFieldStale(s,n)}}}function ue(r,e=null){let t="",s="",i=!1;for(const n of r){if(s){if(ps.includes(n)){s+=n;continue}const a=e==null?void 0:e[s.slice(1)];t+=typeof a<"u"?JSON.stringify(a):"undefined",s=""}if(n==="$"&&!i){s="$";continue}n==='"'&&(i=!i),t+=n}return t}const ps="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789",q="_ROOT_";class gs{constructor(e,t){m(this,"rootID");m(this,"cache");m(this,"lists",new Map);m(this,"listsByField",new Map);this.rootID=t,this.cache=e}get(e,t,s,i){const n=this.getLists(e,t,s);return n?i?new _e(n.lists.filter(a=>!i.has(a.fieldRef))):n:null}getLists(e,t,s){var f;const i=this.lists.get(e);if(!i||i.size===0)return null;if(s)return new _e(Array.from(i,([c,o])=>[...o.lists]).flat());const n=[...i.values()][0],{recordType:a}=n.lists[0],l=t?this.cache._internal_unstable.id(a||"",t):this.rootID;return(i==null?void 0:i.size)===1?t?l===Array.from(i.keys())[0]?n:null:n:t?(f=this.lists.get(e))==null?void 0:f.get(l):(console.error(`Found multiple instances of "${e}". Please provide one of @parentID or @allLists directives to help identify which list you want modify. For more information, visit this guide: https://www.houdinigraphql.com/api/graphql#parentidvalue-string `),null)}remove(e,t){var s;(s=this.lists.get(e))==null||s.delete(t||this.rootID)}add(e){var n,a,l;this.lists.has(e.name)||this.lists.set(e.name,new Map);const t=e.name,s=e.recordID||this.rootID;if((a=(n=this.lists.get(t))==null?void 0:n.get(s))!=null&&a.includes(e.key))return;this.lists.has(t)||this.lists.set(t,new Map),this.lists.get(t).has(s)||this.lists.get(t).set(s,new _e([])),this.listsByField.has(s)||this.listsByField.set(s,new Map),this.listsByField.get(s).has(e.key)||(l=this.listsByField.get(s))==null||l.set(e.key,[]);const i=new ys({...e,manager:this});this.lists.get(e.name).get(s).lists.push(i),this.listsByField.get(s).get(e.key).push(i)}removeIDFromAllLists(e,t){let s=!1;for(const i of this.lists.values())for(const n of i.values())n.removeID(e,void 0,t)&&(s=!0);return s}deleteField(e,t){var s,i,n,a,l,f;if((s=this.listsByField.get(e))!=null&&s.has(t)){for(const c of this.listsByField.get(e).get(t))(n=(i=this.lists.get(c.name))==null?void 0:i.get(c.recordID))==null||n.deleteListWithKey(t),((l=(a=this.lists.get(c.name))==null?void 0:a.get(c.recordID))==null?void 0:l.lists.length)===0&&((f=this.lists.get(c.name))==null||f.delete(c.recordID));this.listsByField.get(e).delete(t)}}reset(){this.lists.clear(),this.listsByField.clear()}}class ys{constructor({name:e,recordID:t,recordType:s,key:i,listType:n,selection:a,when:l,filters:f,connection:c,manager:o,abstract:d}){m(this,"recordID");m(this,"recordType");m(this,"key");m(this,"type");m(this,"cache");m(this,"selection");m(this,"_when");m(this,"filters");m(this,"name");m(this,"connection");m(this,"manager");m(this,"abstract");this.recordID=t||q,this.recordType=s,this.key=i,this.type=n,this.cache=o.cache,this.selection=a,this._when=l,this.filters=f,this.name=e,this.connection=c,this.manager=o,this.abstract=d}get fieldRef(){return`${this.recordID}.${this.key}`}when(e){return this.manager.lists.get(this.name).get(this.recordID).when(e)}append({selection:e,data:t,variables:s={},layer:i}){return this.addToList(e,t,s,"last",i)}prepend({selection:e,data:t,variables:s={},layer:i}){return this.addToList(e,t,s,"first",i)}addToList(e,t,s={},i,n){const a=this.listType(t),l=this.cache._internal_unstable.id(a,t);if(!this.validateWhen()||!l)return;let f=e,c=t;this.connection?(f={fields:{newEntry:{keyRaw:this.key,type:"Connection",selection:{fields:{edges:{keyRaw:"edges",type:"ConnectionEdge",updates:["append","prepend"],selection:{fields:{__typename:{keyRaw:"__typename",type:"String"},node:{type:a,keyRaw:"node",selection:{...e,fields:{...e.fields,__typename:{keyRaw:"__typename",type:"String"}}}}}}}}}}}},c={newEntry:{edges:[{__typename:a+"Edge",node:{...t,__typename:a}}]}}):(f={fields:{newEntries:{keyRaw:this.key,type:a,updates:["append","prepend"],selection:{...e,fields:{...e.fields,__typename:{keyRaw:"__typename",type:"String"}}}}}},c={newEntries:[{...t,__typename:a}]}),this.cache.write({selection:f,data:c,variables:s,parent:this.recordID,applyUpdates:[i==="first"?"prepend":"append"],layer:n==null?void 0:n.id})}removeID(e,t={},s){var c;if(!this.validateWhen())return;let i=this.recordID,n=e,a=this.key;if(this.connection){const{value:o}=this.cache._internal_unstable.storage.get(this.recordID,this.key);if(!o)return;const d=o,{value:u}=this.cache._internal_unstable.storage.get(d,"edges");for(const h of J(u)||[]){if(!h)continue;const y=h,{value:p}=this.cache._internal_unstable.storage.get(y,"node");p&&p===e&&(n=y)}i=d,a="edges"}let l=this.cache._internal_unstable.storage.get(i,a).value;if(!l||!l.includes(n))return;const f=this.cache._internal_unstable.subscriptions.get(this.recordID,this.key);this.cache._internal_unstable.subscriptions.remove(n,this.connection?this.selection.fields.edges.selection:this.selection,f.map(o=>o[0]),t),this.cache._internal_unstable.storage.remove(i,a,n,s);for(const[o]of f)o.set(this.cache._internal_unstable.getSelection({parent:o.parentID||this.manager.rootID,selection:o.selection,variables:((c=o.variables)==null?void 0:c.call(o))||{},ignoreMasking:!1}).data);return!0}remove(e,t={},s){const i=this.cache._internal_unstable.id(this.listType(e),e);if(i)return this.removeID(i,t,s)}listType(e){return e.__typename||this.type}validateWhen(e){let t=e||this._when,s=!0;if(t){const i=this.filters;t.must&&i&&(s=Object.entries(t.must).reduce((n,[a,l])=>!!(n&&i[a]==l),s)),t.must_not&&(s=!i||Object.entries(t.must_not).reduce((n,[a,l])=>!!(n&&i[a]!=l),s))}return s}toggleElement({selection:e,data:t,variables:s={},layer:i,where:n}){this.remove(t,s,i)||this.addToList(e,t,s,n,i)}*[Symbol.iterator](){let e=[],t=this.cache._internal_unstable.storage.get(this.recordID,this.key).value;this.connection?e=this.cache._internal_unstable.storage.get(t,"edges").value:e=J(t);for(let s of e)yield s}}class _e{constructor(e){m(this,"lists",[]);this.lists=e}get selection(){return this.lists[0].selection}append(...e){this.lists.forEach(t=>t.append(...e))}prepend(...e){this.lists.forEach(t=>t.prepend(...e))}addToList(...e){this.lists.forEach(t=>t.addToList(...e))}removeID(...e){let t=!1;return this.lists.forEach(s=>{s.removeID(...e)&&(t=!0)}),t}remove(...e){this.lists.forEach(t=>t.remove(...e))}toggleElement(...e){this.lists.forEach(t=>t.toggleElement(...e))}when(e){return new _e(this.lists.filter(t=>t.validateWhen(e)))}includes(e){return!!this.lists.find(t=>t.key===e)}deleteListWithKey(e){return this.lists=this.lists.filter(t=>t.key!==e)}*[Symbol.iterator](){for(let e of this.lists)for(const t of e)yield t}}var ve;class bs{constructor(e){m(this,"cache");m(this,"fieldsTime",new Map);L(this,ve,e=>{this.fieldsTime.get(e)||this.fieldsTime.set(e,new Map)});this.cache=e}getFieldTime(e,t){var s;return(s=this.fieldsTime.get(e))==null?void 0:s.get(t)}setFieldTimeToNow(e,t){var s;v(this,ve).call(this,e),(s=this.fieldsTime.get(e))==null||s.set(t,new Date().valueOf())}markFieldStale(e,t){var s;v(this,ve).call(this,e),(s=this.fieldsTime.get(e))==null||s.set(t,null)}markAllStale(){for(const[e,t]of this.fieldsTime.entries())for(const[s]of t.entries())this.markFieldStale(e,s)}markRecordStale(e){const t=this.fieldsTime.get(e);if(t)for(const[s]of t.entries())this.markFieldStale(e,s)}markTypeStale(e){for(const[t,s]of this.fieldsTime.entries())if(t.startsWith(`${e}:`))for(const[i]of s.entries())this.markFieldStale(t,i)}markTypeFieldStale(e,t,s){const i=pt({field:t,args:s});for(const[n,a]of this.fieldsTime.entries())if(n.startsWith(`${e}:`))for(const l of a.keys())l===i&&this.markFieldStale(n,t)}delete(e,t){var s,i;this.fieldsTime.has(e)&&((s=this.fieldsTime.get(e))==null||s.delete(t),((i=this.fieldsTime.get(e))==null?void 0:i.size)===0&&this.fieldsTime.delete(e))}reset(){this.fieldsTime.clear()}}ve=new WeakMap;class ms{constructor(){m(this,"data");m(this,"idCount",1);m(this,"rank",0);m(this,"idMaps",{});this.data=[]}get layerCount(){return this.data.length}get nextRank(){return this.rank++}registerIDMapping(e,t){this.idMaps[e]=t,this.idMaps[t]=e}createLayer(e=!1){const t=new _s(this.idCount++);return t.optimistic=e,this.data.push(t),t}insert(e,t,s,i){return this.topLayer.insert(e,t,s,i)}remove(e,t,s,i=this.topLayer){return i.remove(e,t,s)}delete(e,t=this.topLayer){return t.delete(e)}deleteField(e,t){return this.topLayer.deleteField(e,t)}getLayer(e){for(const t of this.data)if(t.id===e)return t;throw new Error("Could not find layer with id: "+e)}replaceID(e){for(const t of this.data)t.replaceID(e)}get(e,t,s){const i={[ee.insert]:{[Re.start]:[],[Re.end]:[]},[ee.remove]:new Set},n=[],a=[this.idMaps[e],e].filter(Boolean);for(let l=this.data.length-1;l>=0;l--)for(const f of a){const c=this.data[l];let[o,d]=c.get(f,t);const u=c.getOperations(f,t)||[];if(c.deletedIDs.forEach(h=>{var y,p;(p=(y=c.operations[h])==null?void 0:y.undoDeletesInList)!=null&&p.includes(t)||(i.remove.add(h),this.idMaps[h]&&i.remove.add(this.idMaps[h]))}),typeof o>"u"&&s&&(this.topLayer.writeField(f,t,s),o=s),typeof o>"u"&&u.length===0){c.deletedIDs.size>0&&n.push(c.id);continue}if(typeof o<"u"&&!Array.isArray(o))return{value:o,kind:d,displayLayers:[c.id]};if(n.push(c.id),u.length>0){for(const h of u)if(ks(h)&&i.remove.add(h.id),vs(h)&&(h.location===Re.end?i.insert[h.location].unshift(h.id):i.insert[h.location].push(h.id)),ws(h))return{value:void 0,kind:"unknown",displayLayers:[]}}if(!(typeof o>"u"))return!i.remove.size&&!i.insert.start.length&&!i.insert.end.length?{value:o,displayLayers:n,kind:"link"}:{value:[...i.insert.start,...o,...i.insert.end].filter(h=>!i.remove.has(h)),displayLayers:n,kind:d}}return{value:void 0,kind:"unknown",displayLayers:[]}}writeLink(e,t,s){return this.topLayer.writeLink(e,t,s)}writeField(e,t,s){return this.topLayer.writeField(e,t,s)}resolveLayer(e){let t=null;for(const[n,a]of this.data.entries())if(a.id===e){t=n-1,this.data[n].optimistic=!1;break}if(t===null)throw new Error("could not find layer with id: "+e);t===-1&&(t=0),this.data[t].optimistic&&t++;const s=this.data[t];let i=t;for(;i<this.data.length;){const n=this.data[i++];if(n.optimistic){i--;break}s.writeLayer(n)}this.data.splice(t+1,i-t-1),this.data.length===1&&(this.idMaps={})}get topLayer(){var e;return this.data.length===0&&this.createLayer(),(e=this.data[this.data.length-1])!=null&&e.optimistic&&this.createLayer(),this.data[this.data.length-1]}serialize(){return JSON.stringify({rank:this.rank,fields:Object.fromEntries(Object.entries(this.topLayer.fields).map(([e,t])=>[e,Object.fromEntries(Object.entries(t).filter(([s,i])=>typeof i!="function"))])),links:this.topLayer.links})}hydrate(e,t){if(!e)return;const{rank:s,fields:i,links:n}=e;this.rank=s,t??(t=this.createLayer(!0)),t.fields=i,t.links=n}reset(){this.data=[]}}class _s{constructor(e){m(this,"id");m(this,"optimistic",!1);m(this,"fields",{});m(this,"links",{});m(this,"operations",{});m(this,"deletedIDs",new Set);this.id=e}get(e,t){var s,i;return typeof((s=this.links[e])==null?void 0:s[t])<"u"?[this.links[e][t],"link"]:[(i=this.fields[e])==null?void 0:i[t],"scalar"]}getOperations(e,t){var s,i,n;if((s=this.operations[e])!=null&&s.deleted)return[{kind:ee.delete,target:e}];if((n=(i=this.operations[e])==null?void 0:i.fields)!=null&&n[t])return this.operations[e].fields[t]}writeField(e,t,s){return this.fields[e]={...this.fields[e],[t]:s},this.id}writeLink(e,t,s){var n,a,l;const i=Array.isArray(s)?s:[s];for(const f of J(i)){if(!f)continue;const c=(n=this.operations[e])==null?void 0:n.fields[t];(a=this.operations[f])!=null&&a.deleted||this.deletedIDs.has(f)?this.operations[f]={...this.operations[f],undoDeletesInList:[...((l=this.operations[e])==null?void 0:l.undoDeletesInList)||[],t]}:f&&(c==null?void 0:c.length)>0&&(this.operations[e].fields[t]=c.filter(o=>o.kind!=="remove"||o.id!==f))}return this.links[e]={...this.links[e],[t]:s},this.id}isDisplayLayer(e){return e.length===0||e.includes(this.id)||Math.max(...e)<this.id}clear(){this.links={},this.fields={},this.operations={},this.deletedIDs=new Set}replaceID({from:e,to:t}){this.fields[t]=this.fields[e],this.links[t]=this.links[e],this.operations[t]=this.operations[e]||{fields:{}},this.deletedIDs.has(e)&&this.deletedIDs.add(t)}removeUndefinedFields(){for(const[e,t]of Object.entries(this.fields)){for(const[s,i]of Object.entries(t))if(typeof i>"u"){try{delete this.fields[e][s]}catch{}try{delete this.links[e][s]}catch{}}Object.keys(t||{}).length===0&&delete this.fields[e],Object.keys(this.links[e]||{}).length===0&&delete this.links[e]}}delete(e){this.operations={...this.operations,[e]:{...this.operations[e],deleted:!0,undoDeletesInList:[]}},this.deletedIDs.add(e)}deleteField(e,t){this.fields[e]={...this.fields[e],[t]:void 0}}insert(e,t,s,i){this.addFieldOperation(e,t,{kind:ee.insert,id:i,location:s})}remove(e,t,s){this.addFieldOperation(e,t,{kind:ee.remove,id:s})}writeLayer(e){if(e.id!==this.id){for(const[t,s]of Object.entries(e.operations)){const i={};for(const n of[e.operations[t],this.operations[t]].filter(Boolean))for(const[a,l]of Object.entries(n.fields||{}))i[a]=[...i[a]||[],...l];Object.keys(i).length>0&&(this.operations[t]={...this.operations[t],fields:i}),s!=null&&s.deleted&&(delete this.fields[t],delete this.links[t])}for(const[t,s]of Object.entries(e.fields))if(s)for(const[i,n]of Object.entries(s))this.writeField(t,i,n);for(const[t,s]of Object.entries(e.links))if(s)for(const[i,n]of Object.entries(s))this.writeLink(t,i,n);e.deletedIDs.forEach(t=>this.deletedIDs.add(t))}}addFieldOperation(e,t,s){var i,n;this.operations={...this.operations,[e]:{...this.operations[e],fields:{...(i=this.operations[e])==null?void 0:i.fields,[t]:[...((n=this.operations[e])==null?void 0:n.fields[t])||[],s]}}}}}function ws(r){return!!r&&r.kind===ee.delete}function vs(r){return!!r&&r.kind===ee.insert}function ks(r){return!!r&&r.kind===ee.remove}const Re={start:"start",end:"end"},ee={delete:"delete",insert:"insert",remove:"remove"};class Ss{constructor(e){m(this,"cache");m(this,"subscribers",new Map);m(this,"keyVersions",{});this.cache=e}activeFields(e){return Object.keys(this.subscribers.get(e)||{})}copySubscribers(e,t){this.subscribers.set(t,this.subscribers.get(e)||new Map)}add({parent:e,spec:t,selection:s,variables:i,parentType:n}){const a=this.cache._internal_unstable.storage.get(e,"__typename").value;let l=H(s,a,!1);for(const f of Object.values(l||{})){const{keyRaw:c,selection:o,type:d,list:u,filters:h,visible:y}=f;if(!y)continue;const p=ue(c,i);let w;if(o){const _=this.cache._internal_unstable.storage.get(e,"__typename").value;w=H(o,_,!1)}if(this.addFieldSubscription({id:e,key:p,selection:[t,w],type:d}),u&&this.registerList({list:u,filters:h,id:e,key:p,variables:i,selection:o,parentType:n||t.rootType}),o){const{value:_}=this.cache._internal_unstable.storage.get(e,p);let b=Array.isArray(_)?J(_)||[]:[_];for(const k of b)k&&this.add({parent:k,spec:t,selection:o,variables:i,parentType:d})}}}addFieldSubscription({id:e,key:t,selection:s,type:i}){const n=s[0];this.subscribers.has(e)||this.subscribers.set(e,new Map);const a=this.subscribers.get(e);a.has(t)||a.set(t,{selections:[],referenceCounts:new Map});const l=a.get(t);this.keyVersions[t]||(this.keyVersions[t]=new Set),this.keyVersions[t].add(t),l.selections.some(([{set:f}])=>f===n.set)||l.selections.push([n,s[1]]),l.referenceCounts.set(n.set,(l.referenceCounts.get(n.set)||0)+1),this.cache._internal_unstable.lifetimes.resetLifetime(e,t)}registerList({list:e,id:t,key:s,parentType:i,selection:n,filters:a,variables:l}){var f;this.cache._internal_unstable.lists.add({name:e.name,connection:e.connection,recordID:t,recordType:((f=this.cache._internal_unstable.storage.get(t,"__typename"))==null?void 0:f.value)||i,listType:e.type,key:s,selection:n,filters:Object.entries(a||{}).reduce((c,[o,{kind:d,value:u}])=>({...c,[o]:d!=="Variable"?u:l[u]}),{})})}addMany({parent:e,variables:t,subscribers:s,parentType:i}){for(const[n,a]of s)for(const l of Object.values(a??{})){const{type:f,keyRaw:c,selection:o,list:d,filters:u}=l,h=ue(c,t),y=o?H(o,i,!1):void 0;this.addFieldSubscription({id:e,key:h,selection:[n,y],type:f}),d&&this.registerList({list:d,filters:u,id:e,key:h,variables:t,selection:o,parentType:i||n.rootType});const p=l.selection;if(p){const{value:w}=this.cache._internal_unstable.storage.get(e,h),_=Array.isArray(w)?J(w):[w];for(const b of _){if(!b)continue;const k=this.cache._internal_unstable.storage.get(b,"__typename").value;let D=H(p,k,!1);this.addMany({parent:b,variables:t,subscribers:s.map(([C])=>[C,D]),parentType:f})}}}}get(e,t){var s,i;return((i=(s=this.subscribers.get(e))==null?void 0:s.get(t))==null?void 0:i.selections)||[]}getAll(e){var t;return[...((t=this.subscribers.get(e))==null?void 0:t.values())||[]].flatMap(s=>s.selections)}remove(e,t,s,i,n=[]){n.push(e);const a=[],l=this.cache._internal_unstable.storage.get(e,"__typename").value;let f=H(t,l,!1);for(const c of Object.values(f||{})){const o=ue(c.keyRaw,i);if(this.removeSubscribers(e,o,s),!c.selection)continue;const{value:d}=this.cache._internal_unstable.storage.get(e,o),u=Array.isArray(d)?J(d):[d];for(const h of u)h!==null&&a.push([h,c.selection||{}])}for(const[c,o]of a)this.remove(c,o,s,n)}reset(){const e=[...this.subscribers.entries()].filter(([s])=>!s.startsWith(q));for(const[s,i]of e)this.subscribers.delete(s);return e.flatMap(([s,i])=>[...i.values()].flatMap(n=>n.selections.map(([a])=>a)))}removeSubscribers(e,t,s){let i=[];const n=this.subscribers.get(e);if(!n)return;const a=n.get(t);for(const l of s){const f=a==null?void 0:a.referenceCounts;if(!(f!=null&&f.has(l.set)))continue;const c=(f.get(l.set)||0)-1;f.set(l.set,c),c<=0&&(i.push(l.set),f.delete(l.set)),f.size===0&&n.delete(t)}a&&(a.selections=this.get(e,t).filter(([{set:l}])=>!i.includes(l))),n.size===0&&this.subscribers.delete(e)}removeAllSubscribers(e,t){var s;t||(t=[...((s=this.subscribers.get(e))==null?void 0:s.values())||[]].flatMap(i=>i.selections.flatMap(n=>n[0])));for(const i of t)for(const n of this.findSubSelections(i.parentID||q,i.selection,i.variables||{},e))this.remove(e,n,t,i.variables||{})}get size(){let e=0;for(const[,t]of this.subscribers)for(const[,{referenceCounts:s}]of t)e+=[...s.values()].reduce((i,n)=>i+n,0);return e}findSubSelections(e,t,s,i,n=[]){const a=this.cache._internal_unstable.storage.get(e,"__typename").value;let l=H(t,a,!1);for(const f of Object.values(l||{})){if(!f.selection)continue;const c=ue(f.keyRaw,s||{}),o=this.cache._internal_unstable.storage.get(e,c),d=Array.isArray(o.value)?J(o.value):[o.value];if(d.includes(i))n.push(f.selection);else for(const u of d)this.findSubSelections(u,f.selection,s,i,n)}return n}}var Ds={},de,De;class gt{constructor({disabled:e,componentCache:t,createComponent:s,...i}={}){L(this,de);m(this,"_internal_unstable");this._internal_unstable=new Is({cache:this,storage:new ms,subscriptions:new Ss(this),lists:new gs(this,q),lifetimes:new ds(this),staleManager:new bs(this),disabled:e??typeof globalThis.window>"u",componentCache:t,createComponent:s}),Object.keys(i).length>0&&this.setConfig(Be(i))}write({layer:e,notifySubscribers:t=[],...s}){const i=e?this._internal_unstable.storage.getLayer(e):this._internal_unstable.storage.topLayer,n=this._internal_unstable.writeSelection({...s,layer:i}).map(a=>a[0]);return P(this,de,De).call(this,n.concat(t)),n}read(...e){const{data:t,partial:s,stale:i,hasData:n}=this._internal_unstable.getSelection(...e);return n?{data:t,partial:s,stale:i}:{data:null,partial:!1,stale:!1}}subscribe(e,t={}){if(!this._internal_unstable.disabled)return this._internal_unstable.subscriptions.add({parent:e.parentID||q,spec:e,selection:e.selection,variables:t})}unsubscribe(e,t={}){return this._internal_unstable.subscriptions.remove(e.parentID||q,e.selection,[e],t)}list(e,t,s,i){const n=this._internal_unstable.lists.get(e,t,s,i);if(!n)throw new Error(`Cannot find list with name: ${e}${t?" under parent "+t:""}. Is it possible that the query is not mounted?`);return n}registerKeyMap(e,t){this._internal_unstable.storage.registerIDMapping(e,t),this._internal_unstable.subscriptions.copySubscribers(e,t)}delete(e,t){const s=[this._internal_unstable.storage.idMaps[e],e].filter(Boolean);for(const i of s)this._internal_unstable.subscriptions.removeAllSubscribers(i),this._internal_unstable.lists.removeIDFromAllLists(i,t),this._internal_unstable.storage.delete(i,t)}setConfig(e){this._internal_unstable.setConfig(e)}markTypeStale(e){e?e.field?this._internal_unstable.staleManager.markTypeFieldStale(e.type,e.field,e.when):this._internal_unstable.staleManager.markTypeStale(e.type):this._internal_unstable.staleManager.markAllStale()}markRecordStale(e,t){if(t.field){const s=pt({field:t.field,args:t.when??{}});this._internal_unstable.staleManager.markFieldStale(e,s)}else this._internal_unstable.staleManager.markRecordStale(e)}getFieldTime(e,t){return this._internal_unstable.staleManager.getFieldTime(e,t)}config(){return this._internal_unstable.config}serialize(){return this._internal_unstable.storage.serialize()}hydrate(...e){return this._internal_unstable.storage.hydrate(...e)}clearLayer(e){const t=this._internal_unstable.storage.getLayer(e);if(!t)throw new Error("Cannot find layer with id: "+e);const s=[],i=[];for(const a of[t.fields,t.links])for(const[l,f]of Object.entries(a))i.push(...Object.entries(f).map(([c,o])=>({id:l,field:c,value:o})));const n=[];for(const a of i){const{displayLayers:l}=this._internal_unstable.storage.get(a.id,a.field);l.includes(e)&&n.push(a)}for(const[a,l]of Object.entries(t.operations)){l.deleted&&n.push(...this._internal_unstable.subscriptions.activeFields(a).map(c=>({id:a,field:c})));const f=Object.keys(l.fields??{});f.length>0&&n.push(...f.map(c=>({id:a,field:c})))}t.clear();for(const a of n){const{field:l,id:f}=a;(!("value"in a)||this._internal_unstable.storage.get(f,l).value!==a.value)&&s.push(...this._internal_unstable.subscriptions.get(f,l).map(o=>o[0]))}P(this,de,De).call(this,s)}reset(){const e=this._internal_unstable.subscriptions.reset();this._internal_unstable.staleManager.reset(),this._internal_unstable.lifetimes.reset(),this._internal_unstable.lists.reset(),this._internal_unstable.storage.reset(),P(this,de,De).call(this,e)}}de=new WeakSet,De=function(e){var s;if(e.length===0)return;const t=[];for(const i of e)t.includes(i.set)||(t.push(i.set),i.set(this._internal_unstable.getSelection({parent:i.parentID||q,selection:i.selection,variables:((s=i.variables)==null?void 0:s.call(i))||{},ignoreMasking:!1}).data))};class Is{constructor({storage:e,subscriptions:t,lists:s,cache:i,lifetimes:n,staleManager:a,disabled:l,config:f,componentCache:c,createComponent:o}){m(this,"disabled",!1);m(this,"_config");m(this,"storage");m(this,"subscriptions");m(this,"lists");m(this,"cache");m(this,"lifetimes");m(this,"staleManager");m(this,"componentCache");m(this,"createComponent");this.storage=e,this.subscriptions=t,this.lists=s,this.cache=i,this.lifetimes=n,this.staleManager=a,this._config=f,this.componentCache=c??{},this.createComponent=o??(()=>({})),this.disabled=l;try{Ds.HOUDINI_TEST==="true"&&(this.disabled=!1)}catch{}}get config(){return this._config??Se()}setConfig(e){this._config=e}writeSelection({data:e,selection:t,variables:s={},parent:i=q,applyUpdates:n,layer:a,toNotify:l=[],forceNotify:f,forceStale:c}){if(this.disabled)return[];let o=H(t,e.__typename,!1);for(const[d,u]of Object.entries(e)){if(!t||!o[d])continue;let{type:h,keyRaw:y,selection:p,operations:w,abstract:_,updates:b}=o[d];const k=ue(y,s);u&&typeof u=="object"&&"__typename"in u&&u.__typename&&(h=u.__typename);const D=this.subscriptions.get(i,k),C=D.map(g=>g[0]),{value:O,displayLayers:B}=this.storage.get(i,k),K=a.isDisplayLayer(B);if(K&&(this.lifetimes.resetLifetime(i,k),c?this.staleManager.markFieldStale(i,k):this.staleManager.setFieldTimeToNow(i,k)),p){if(u===null){if(O===null)continue;const g=J([O]);for(const M of g)this.subscriptions.remove(M,p,C,s);a.writeLink(i,k,null),l.push(...D)}else if(u instanceof Object&&!Array.isArray(u)){if(_&&!u.__typename)throw new Error("Encountered interface type without __typename in the payload");let g=null;u!==null&&(g=this.isEmbedded(h,u)?`${i}.${k}`:this.id(h,u));let M=g!==O;a.writeLink(i,k,g),g&&K&&(M||f)&&(O&&typeof O=="string"&&this.subscriptions.remove(O,p,C,s),this.subscriptions.addMany({parent:g,subscribers:D,variables:s,parentType:h}),l.push(...D)),g&&this.writeSelection({selection:p,parent:g,data:u,variables:s,toNotify:l,applyUpdates:n,layer:a,forceNotify:f})}else if(Array.isArray(u)&&(typeof O>"u"||O===null||Array.isArray(O))){let g=[...O||[]];const M=b?g.map(T=>{if(!T)return"";const{value:S}=this.storage.get(T,"cursor");if(S)return"";const{value:j}=this.storage.get(T,"node");return j||""}):[];let A=[];const{newIDs:I,nestedIDs:$}=this.extractNestedListIDs({value:u,abstract:!!_,specs:l,applyUpdates:n,recordID:i,key:k,linkedType:h,variables:s,fields:p,layer:a,forceNotify:f});let V=()=>{a.writeLink(i,k,A)};if(n&&b){if(k==="edges"){const T=[];for(const S of I){if(!S)continue;const{value:j}=this.storage.get(S,"node");typeof j=="string"&&(!j||!this.storage.get(j,"__typename")||T.push(j))}g=g.filter(S=>{if(!S)return!0;const{value:j}=this.storage.get(S,"node"),z=j;return!(T.includes(z)&&M.includes(z))})}for(const T of n)T!=="replace"&&!b.includes(T)||(T==="prepend"?(A=I.concat(g),a!=null&&a.optimistic&&(V=()=>{for(const S of I)S&&a.insert(i,k,"start",S)})):T==="append"?(A=g.concat(I),a!=null&&a.optimistic&&(V=()=>{for(const S of I)S&&a.insert(i,k,"end",S)})):T==="replace"&&(A=I))}else A=$;const le=!Oe(A,g)||O===null;(le||f)&&l.push(...D);for(const T of g)A.includes(T)||!T||this.subscriptions.remove(T,p,C,s);(le||g.length===0&&I.length===0)&&V();for(const T of I.filter(S=>!g.includes(S)))T!=null&&this.subscriptions.addMany({parent:T,subscribers:D,variables:s,parentType:h})}}else{let g=u;if(b&&n&&Array.isArray(u))for(const A of n)b.includes(A)&&(A==="append"?g=(O||[]).concat(u):A==="prepend"&&(g=u.concat(O||[])));(b&&(n!=null&&n.includes("prepend"))&&["endCursor","hasNextPage"].includes(k)||b&&(n!=null&&n.includes("append"))&&["startCursor","hasPreviousPage"].includes(k))&&(g=O);const M=!Oe(g,O);K&&(M||f)&&l.push(...D),a.writeField(i,k,g)}const R=new Set;for(const g of w||[]){let M;if(g.parentID)if(g.parentID.kind!=="Variable")M=g.parentID.value;else{const I=s[g.parentID.value];if(typeof I!="string")throw new Error("parentID value must be a string");M=I}if(g.list&&!this.lists.get(g.list,M,g.target==="all"))continue;const A=Array.isArray(u)?u:[u];for(const I of A)if(g.action==="insert"&&I instanceof Object&&p&&g.list)this.cache.list(g.list,M,g.target==="all",R).when(g.when).addToList(p,I,s,g.position||"last",a);else if(g.action==="toggle"&&I instanceof Object&&p&&g.list)this.cache.list(g.list,M,g.target==="all",R).when(g.when).toggleElement({selection:p,data:I,variables:s,where:g.position||"last",layer:a});else if(g.action==="remove"&&I instanceof Object&&p&&g.list)this.cache.list(g.list,M,g.target==="all",R).when(g.when).remove(I,s,a);else if(g.action==="delete"&&g.type&&I){const $=this.id(g.type,I);if(!$)continue;l.push(...this.subscriptions.getAll($).filter(V=>V[0].parentID!==$)),this.cache.delete($,a)}if(g.list){const I=this.cache.list(g.list,M,g.target==="all");for(const $ of I.lists)R.add($.fieldRef)}}}return l}getSelection({selection:e,parent:t=q,variables:s,stepsFromConnection:i=null,ignoreMasking:n,fullCheck:a=!1,loading:l}){var p,w,_;if(t===null)return{data:null,partial:!1,stale:!1,hasData:!0};const f={};e.fragments&&(f[xe]={loading:!!l,values:Object.fromEntries(Object.entries(e.fragments).filter(([,b])=>!l||b.loading).map(([b,k])=>[b,{parent:t,variables:Ie(k.arguments,s??{})}]))});let c=!!e.fragments,o=!1,d=!1,u=!1;const h=this.storage.get(t,"__typename").value;let y=H(e,h,!!l);for(const[b,{type:k,keyRaw:D,selection:C,nullable:O,list:B,visible:K,directives:R,loading:g,abstractHasRequired:M,component:A}]of Object.entries(y)){if(!K&&!n&&!a)continue;const I=R==null?void 0:R.find(E=>E.name==="include");if(I&&!Ie(I.arguments,s??{}).if)continue;const $=R==null?void 0:R.find(E=>E.name==="skip");if($&&Ie($.arguments,s??{}).if)continue;const V=K||n?f:{},le=ue(D,s);if(l&&!g)continue;const T=A?Os({cache:this.cache,component:A,variables:s,parent:t}):void 0;let{value:S}=this.storage.get(t,le,T);this.staleManager.getFieldTime(t,le)===null&&(u=!0),l&&(S=void 0);let z=i;z!==null&&(z>=2?z=null:z+=1),B!=null&&B.connection&&(z=0);const We=le==="cursor"&&i===1;if(typeof S>"u"&&!We&&(o=!0),l&&(g==null?void 0:g.kind)==="value")V[b]=cs,c=!0;else if(!l&&typeof S>"u"||S===null)V[b]=null,typeof S<"u"&&(c=!0);else if(C)if(Array.isArray(S)){const E=this.hydrateNestedList({fields:C,variables:s,linkedList:S,stepsFromConnection:z,ignoreMasking:!!n,fullCheck:a,loading:l,nullable:!!O});V[b]=E.data,E.partial&&(o=!0),E.cascadeNull&&(d=!0),E.stale&&(u=!0),(E.hasData||S.length===0)&&(c=!0)}else{const E=this.getSelection({parent:S,selection:C,variables:s,stepsFromConnection:z,ignoreMasking:n,fullCheck:a,loading:l});V[b]=E.data,E.partial&&(o=!0),E.stale&&(u=!0),E.hasData&&(c=!0)}else{const E=(_=(w=(p=this.config)==null?void 0:p.scalars)==null?void 0:w[k])==null?void 0:_.unmarshal;E?Array.isArray(S)?V[b]=S.map(bt=>E(bt)):V[b]=E(S):V[b]=S,c=!0}l&&(g!=null&&g.list)&&(V[b]=yt(Array.from({length:g.list.count}).fill(V[b]),g.list.depth-1)),V[b]===null&&!O&&!We&&(M?f[b]={__typename:"@required field missing; don't match this"}:d=!0)}return{data:d?null:f,partial:!l&&c&&o,stale:c&&u,hasData:c}}id(e,t){const s=typeof t=="object"?this.computeID(e,t):t;return s?e?e+":"+s:s:null}idFields(e){return ut(this.config,e)}computeID(e,t){return ns(this.config,e,t)}isEmbedded(e,t){const s=this.idFields(e);return s.length===0||s.filter(i=>typeof t[i]>"u").length>0}hydrateNestedList({fields:e,variables:t,linkedList:s,stepsFromConnection:i,ignoreMasking:n,fullCheck:a,loading:l,nullable:f}){const c=[];let o=!1,d=!1,u=!1,h=!1;for(const y of s){if(Array.isArray(y)){const k=this.hydrateNestedList({fields:e,nullable:f,variables:t,linkedList:y,stepsFromConnection:i,ignoreMasking:n,fullCheck:a,loading:l});c.push(k.data),k.partial&&(o=!0),k.cascadeNull&&(h=!0);continue}if(y===null){c.push(y);continue}const{data:p,partial:w,stale:_,hasData:b}=this.getSelection({parent:y,selection:e,variables:t,stepsFromConnection:i,ignoreMasking:n,fullCheck:a,loading:l});p===null&&!f&&(h=!0),c.push(p),w&&(o=!0),_&&(d=!0),b&&(u=!0)}return{data:c,partial:o,stale:d,hasData:u,cascadeNull:h}}extractNestedListIDs({value:e,abstract:t,recordID:s,key:i,linkedType:n,fields:a,variables:l,applyUpdates:f,specs:c,layer:o,forceNotify:d}){const u=[],h=[];for(const[y,p]of e.entries()){if(Array.isArray(p)){const D=this.extractNestedListIDs({value:p,abstract:t,recordID:s,key:i,linkedType:n,fields:a,variables:l,applyUpdates:f,specs:c,layer:o,forceNotify:d});h.push(...D.newIDs),u[y]=D.nestedIDs;continue}if(p===null||typeof p>"u"){h.push(null),u[y]=null;continue}const w=p;let _=`${s}.${i}[${this.storage.nextRank}]`,b=n;const k=w.__typename;if(k)b=k;else if(t)throw new Error("Encountered interface type without __typename in the payload");if(!this.isEmbedded(n,p)){const D=this.id(b,p);if(D)_=D;else continue}this.writeSelection({root:q,selection:a,parent:_,data:w,variables:l,toNotify:c,applyUpdates:f,layer:o,forceNotify:d}),h.push(_),u[y]=_}return{newIDs:h,nestedIDs:u}}collectGarbage(){this.lifetimes.tick(),this.storage.layerCount===1&&this.storage.topLayer.removeUndefinedFields()}}function Ie(r,e){return Object.fromEntries(Object.entries(r).map(([t,s])=>[t,je(s,e)]))}function yt(r,e=0){return e===0?r:yt([r],e-1)}function je(r,e){if(r.kind==="StringValue"||r.kind==="BooleanValue"||r.kind==="EnumValue")return r.value;if(r.kind==="FloatValue")return parseFloat(r.value);if(r.kind==="IntValue")return parseInt(r.value,10);if(r.kind==="NullValue")return null;if(r.kind==="Variable")return e[r.name.value];if(r.kind==="ListValue")return r.values.map(t=>je(t,e));if(r.kind==="ObjectValue")return r.fields.reduce((t,s)=>({...t,[s.name.value]:je(s.value,e)}),{})}function Os({cache:r,component:e,loading:t,variables:s,parent:i}){return n=>{const a=r._internal_unstable.componentCache[e.key],l=Ie(e.variables??{},s??{});return r._internal_unstable.createComponent(a,{...n,[e.prop]:{[xe]:{loading:t,values:{[e.fragment]:{variables:l,parent:i}}}}})}}var Fs=new gt;const Pe=typeof globalThis.window>"u",Ts=({enabled:r,setFetching:e,cache:t=Fs,serverSideFallback:s=!0})=>()=>({beforeNetwork(i,{initialValue:n,next:a,resolve:l,marshalVariables:f}){var u,h;const{policy:c,artifact:o}=i;let d=!1;if(r&&(o.kind===he.Query||o.kind===he.Fragment)&&!((u=i.cacheParams)!=null&&u.disableRead)&&c!==U.NetworkOnly&&c!==U.NoCache){const p=t.read({selection:o.selection,variables:f(i),fullCheck:!0}),w=!p.partial||o.kind===he.Query&&o.partial;if(c===U.CacheOnly)return l(i,{fetching:!1,variables:i.variables??null,data:w?p.data:n.data,errors:null,source:Ae.Cache,partial:w?p.partial:!1,stale:p.stale});if(d=!!(p.data!==null&&w),d&&l(i,{fetching:!1,variables:i.variables??null,data:p.data,errors:null,source:Ae.Cache,partial:p.partial,stale:p.stale}),d&&!p.partial&&!p.stale&&i.policy!=="CacheAndNetwork")return}if(r&&setTimeout(()=>{t._internal_unstable.collectGarbage()},0),!((h=i.stuff)!=null&&h.silenceLoading)){let y=null;!d&&"enableLoadingState"in o&&o.enableLoadingState&&(y=t.read({selection:o.selection,variables:f(i),loading:!0}).data),e(!d,y)}return a(i)},afterNetwork(i,{resolve:n,value:a,marshalVariables:l}){var f,c,o;if(i.policy!==U.NoCache&&a.source!==Ae.Cache&&r&&a.data&&!((f=i.cacheParams)!=null&&f.disableWrite)){i.cacheParams&&"serverSideFallback"in i.cacheParams&&(s=((c=i.cacheParams)==null?void 0:c.serverSideFallback)??s);const d=Pe&&s?new gt({disabled:!1}):t;let u;!Pe&&((o=i.cacheParams)!=null&&o.layer)&&(u=i.cacheParams.layer.id),d.write({...i.cacheParams,layer:u,selection:i.artifact.selection,data:a.data,variables:l(i)}),a={...a,data:d.read({selection:i.artifact.selection,variables:l(i),ignoreMasking:Pe}).data}}n(i,a)}}),rt={forward:["start","beforeNetwork","network"],backwards:["end","afterNetwork"]};let me={};var se,ke,W,ie,pe,N,x;class Ls extends us{constructor({artifact:t,plugins:s,pipeline:i,client:n,cache:a,enableCache:l=!0,initialValue:f,initialVariables:c,fetching:o}){o??(o=t.kind===he.Query);super({data:f??null,errors:null,partial:!1,stale:!1,source:null,fetching:o,variables:c??null},()=>()=>{F(this,ie,null),this.cleanup()});L(this,N);m(this,"artifact");L(this,se);L(this,ke);L(this,W);L(this,ie);L(this,pe,null);m(this,"pendingPromise",null);m(this,"serverSideFallback");this.artifact=t,F(this,se,n),F(this,ie,null),F(this,ke,Se()),F(this,W,i??[Ts({cache:a,enabled:l,setFetching:(u,h)=>{this.update(y=>{const p={...y,fetching:u};return u&&h&&(p.data=h),p})}})(),...s??[]])}controllerKey(t){var i;const s="dedupe"in this.artifact&&((i=this.artifact.dedupe)==null?void 0:i.match)!==ls.Variables?{}:t;return`${this.artifact.name}@${Ms(s)}`}async send({metadata:t,session:s,fetch:i,variables:n,policy:a,stuff:l,cacheParams:f,setup:c=!1,silenceEcho:o=!1,abortController:d=new AbortController}={}){if("dedupe"in this.artifact&&this.artifact.dedupe&&this.artifact.dedupe.match!=="None"){const w=this.controllerKey(n);me[w]?this.artifact.dedupe.cancel==="first"?(me[w].controller.abort(),me[w].controller=d):d.abort():me[w]={variables:n,controller:d}}let u=new ze({abortController:d,config:v(this,ke),name:this.artifact.name,text:this.artifact.raw,hash:this.artifact.hash,policy:a??this.artifact.policy,variables:null,metadata:t,session:s,fetch:i??this.getFetch(()=>s),stuff:{inputs:{changed:!1,init:!1,marshaled:{}},...l},artifact:this.artifact,lastVariables:v(this,ie),cacheParams:f});const h=u.draft();h.variables=n??null,u=u.apply(h,!1);const y=new Promise((w,_)=>{const b={setup:c,currentStep:0,index:0,silenceEcho:o,promise:{resolved:!1,resolve:w,reject:_,then:(...k)=>y.then(...k)},context:u};this.pendingPromise===null&&(this.pendingPromise=b.promise),P(this,N,x).call(this,"forward",b)}),p=await y;return delete me[this.controllerKey(n)],p}async cleanup(){var t;for(const s of v(this,W))(t=s.cleanup)==null||t.call(s,v(this,pe))}getFetch(t){return async(s,i)=>{var l;let n="",a=[];if(typeof s=="string"&&(n=s.startsWith("http")?new URL(s).pathname:s),s instanceof URL?n=s.pathname:s instanceof Request&&(n=new URL(s.url).pathname),s instanceof Request){const f=await s.json();Array.isArray(f)||(a=[f])}else{const f=JSON.parse(i==null?void 0:i.body);Array.isArray(f)||(a=[f])}if(!n||a.length===0)return await globalThis.fetch(s,i);if((l=v(this,se))!=null&&l.proxies[n]){const f=await Promise.all(a.map(c=>{var o;return(o=v(this,se))==null?void 0:o.proxies[n]({...c,session:t()})}));return new Response(JSON.stringify(f.length===1?f[0]:f))}return await globalThis.fetch(s,i)}}}se=new WeakMap,ke=new WeakMap,W=new WeakMap,ie=new WeakMap,pe=new WeakMap,N=new WeakSet,x=function(t,s,i){var f;const n=t==="error"?"catch":rt[t][s.currentStep];let a=c=>c<=v(this,W).length,l=c=>c+1;["backwards","error"].includes(t)&&(a=c=>c>=0,l=c=>c-1);for(let c=s.index;a(c);c=l(c)){let o=(f=v(this,W)[c])==null?void 0:f[n];if(!o)continue;const d=s.context.draft();let u=p=>p.variables!==d.variables;const h={initialValue:this.state,client:v(this,se),variablesChanged:Es,marshalVariables:Cs,updateState:this.update.bind(this),next:p=>{const w=["forward","error"].includes(t)?c+1:c,_=["backwards","error"].includes(t)?0:s.currentStep;P(this,N,x).call(this,"forward",{...s,index:w,currentStep:_,context:s.context.apply(p,u(p))})},resolve:(p,w)=>{const _=t==="backwards"?c-1:c;P(this,N,x).call(this,"backwards",{...s,index:_,context:s.context.apply(p,u(p))},w)}};let y;t==="forward"?y=h:t==="backwards"?y={...h,value:i,resolve:(p,w)=>h.resolve(p,w??i)}:t==="error"&&(y={...h,error:i});try{if(d.abortController.signal.aborted){const w=new Error("aborted");throw w.name="AbortError",w}const p=o(d,y);p==null||p.catch(w=>{P(this,N,x).call(this,"error",{...s,index:c-1},w)})}catch(p){P(this,N,x).call(this,"error",{...s,index:c-1},p)}return}if(t==="forward"){if(s.setup)return P(this,N,x).call(this,"backwards",{...s,currentStep:0,index:v(this,W).length},this.state);if(s.currentStep<=rt.forward.length-2)return P(this,N,x).call(this,"forward",{...s,currentStep:s.currentStep+1,index:0});throw new Error("Called next() on last possible plugin. Your chain is missing a plugin that calls resolve().")}if(t==="error"){s.promise.resolved||(s.promise.reject(i),s.promise.resolved=!0);return}if(s.currentStep>0)return P(this,N,x).call(this,"backwards",{...s,currentStep:s.currentStep-1,index:v(this,W).length-1},i);(!s.silenceEcho||i.data!==this.state.data)&&this.set(i),s.promise.resolved||(s.promise.resolve(i),s.promise.resolved=!0),F(this,pe,s.context.draft()),F(this,ie,v(this,pe).stuff.inputs.marshaled)};var ne,ge;const Qe=class Qe{constructor({lastVariables:e,...t}){L(this,ne);L(this,ge);F(this,ne,t),F(this,ge,e)}get variables(){return v(this,ne).variables}draft(){const e={...v(this,ne)},t=this.applyVariables.bind(this);return{...e,get stuff(){return e.stuff},set stuff(s){e.stuff=s},get variables(){return e.variables??null},set variables(s){Object.assign(e,t(e,{variables:s}))}}}applyVariables(e,t){var c,o;const s=e.artifact,i={...e,...t},n=t.variables;let a={};for(const[d,u]of Object.entries(n??{}))u!==((c=e.variables)==null?void 0:c[d])&&(a[d]=u);i.stuff={...i.stuff,inputs:{...i.stuff.inputs}};const l=!i.stuff.inputs||!i.stuff.inputs.init;if(Object.keys(a).length>0||l){const d={...(o=i.stuff.inputs)==null?void 0:o.marshaled,...Ne({artifact:s,input:a,config:e.config})};i.stuff.inputs={init:!0,marshaled:d,changed:!0},i.variables=n}return i.stuff={...i.stuff,inputs:{...i.stuff.inputs,changed:!Oe(i.stuff.inputs.marshaled,v(this,ge))}},i}apply(e,t){return t&&(e=this.applyVariables(v(this,ne),e)),new Qe({...e,lastVariables:v(this,ge)})}};ne=new WeakMap,ge=new WeakMap;let ze=Qe;function Cs(r){var e;return((e=r.stuff.inputs)==null?void 0:e.marshaled)??{}}function Es(r){var e;return(e=r.stuff.inputs)==null?void 0:e.changed}function Ms(r){return JSON.stringify(qe(r))}function qe(r){return r===null||typeof r!="object"?r:Array.isArray(r)?r.map(qe):Object.keys(r).sort().reduce((e,t)=>(e[t]=qe(r[t]),e),{})}var re,ye,X,ae,Z;class As{constructor(e){L(this,re);L(this,ye);L(this,X,null);L(this,ae,null);L(this,Z,0);typeof e.initialize>"u"&&(e.initialize=!0),F(this,ye,new Ls({artifact:e.artifact,client:null,fetching:e.fetching,initialValue:e.initialValue})),F(this,re,e)}get artifact(){return v(this,re).artifact}get name(){return this.artifact.name}get observer(){return v(this,ae)?v(this,ae):(F(this,ae,it().observe(v(this,re))),v(this,ae))}subscribe(...e){const t=v(this,ye).subscribe(...e);return(v(this,Z)===0||!v(this,X))&&this.setup(),F(this,Z,(v(this,Z)??0)+1),()=>{var s;Ge(this,Z)._--,v(this,Z)<=0&&((s=v(this,X))==null||s.call(this),F(this,X,null),t())}}setup(e=!0){let t=Promise.resolve();try{it()}catch{t=He()}t.then(()=>{if(!v(this,X)&&(F(this,X,this.observer.subscribe(s=>{v(this,ye).set(s)})),e&&v(this,re).initialize))return this.observer.send({setup:!0,variables:$e(this.observer).variables})})}}re=new WeakMap,ye=new WeakMap,X=new WeakMap,ae=new WeakMap,Z=new WeakMap;class Vs extends As{constructor({artifact:t,storeName:s,variables:i}){var a;const n=((a=t.pluginData["houdini-svelte"])==null?void 0:a.isManualLoad)!==!0;super({artifact:t,fetching:n,initialize:!t.pluginData["houdini-svelte"].isManualLoad});m(this,"variables");m(this,"kind",os);m(this,"loadPending",!1);m(this,"storeName");this.storeName=s,this.variables=i}async fetch(t){var _;const s=await He();this.setup(!1);const{policy:i,params:n,context:a}=await Rs(this.artifact,this.storeName,t),l=!!("event"in n&&n.event),f=!l;if(this.loadPending&&f)return rs(`⚠️ Encountered fetch from your component while ${this.storeName}.load was running.
This will result in duplicate queries. If you are trying to ensure there is always a good value, please a CachePolicy instead.`),$e(this.observer);f&&(n.blocking=!0);const o=Se().plugins["houdini-svelte"],d=this.artifact.pluginData["houdini-svelte"];let u=!1;(s.throwOnError_operations.includes("all")||s.throwOnError_operations.includes("query"))&&o.defaultRouteBlocking===!1&&as('[Houdini] ⚠️ throwOnError with operation "all" or "query", is not compatible with defaultRouteBlocking set to "false"'),o.defaultRouteBlocking===!0&&(u=!0),(s.throwOnError_operations.includes("all")||s.throwOnError_operations.includes("query"))&&(u=!0),(d==null?void 0:d.set_blocking)===!0?u=!0:(d==null?void 0:d.set_blocking)===!1&&(u=!1),(n==null?void 0:n.blocking)===!0?u=!0:(n==null?void 0:n.blocking)===!1&&(u=!1),l&&(this.loadPending=!0),this.artifact.enableLoadingState&&(u=!1);const h=wt&&vt&&!u,y={...(_=this.artifact.input)==null?void 0:_.defaults,...n.variables};i!==U.NetworkOnly&&i!==U.NoCache&&h&&await this.observer.send({fetch:a.fetch,variables:y,metadata:n.metadata,session:a.session,policy:U.CacheOnly,silenceEcho:!0,abortController:n.abortController});const w=this.observer.send({fetch:a.fetch,variables:y,metadata:n.metadata,session:a.session,policy:i,stuff:{}});return w.then(b=>{var k;this.loadPending=!1,(k=n.then)==null||k.call(n,b.data)}).catch(()=>{}),h||await w,$e(this.observer)}}async function Rs(r,e,t){let s=t==null?void 0:t.policy;!s&&r.kind===he.Query&&(s=r.policy??U.CacheOrNetwork);let i=null;t&&("fetch"in t&&t.fetch?i=t.fetch:"event"in t&&t.event&&"fetch"in t.event&&(i=t.event.fetch)),i||(i=globalThis.fetch.bind(globalThis));let n;return t&&"event"in t&&t.event?n=await Ye(t.event):n=await Ye(),{context:{fetch:i,metadata:(t==null?void 0:t.metadata)??{},session:n},policy:s,params:t??{}}}const Ps={name:"KVDemoPage",kind:"HoudiniQuery",hash:"d9541db8d01883c9ff02723ae2fbb68f9964d9704fbbcbeec428ff661f1649e1",raw:`query KVDemoPage {
  KVNames
}
`,rootType:"Query",stripVariables:[],selection:{fields:{KVNames:{type:"String",keyRaw:"KVNames",visible:!0}}},pluginData:{"houdini-svelte":{}},policy:"CacheOrNetwork",partial:!1};class $s extends Vs{constructor(){super({artifact:Ps,storeName:"KVDemoPageStore",variables:!1})}}async function Ns(r){await He();const e=new $s;return await e.fetch(r),{KVDemoPage:e}}async function Ks(r){const e=new kt(r);Se();const t=[],s={};s.KVDemoPage={},t.push(Ns({variables:s.KVDemoPage,event:r,blocking:void 0}));let i={};try{i=Object.assign({},...await Promise.all(t))}catch(n){throw n}return{...e.returnValue,...i}}const Ys=Object.freeze(Object.defineProperty({__proto__:null,load:Ks},Symbol.toStringTag,{value:"Module"}));var js=at("<li> </li>"),zs=at("<h1>Cloudflare KV Demo</h1> <br> <ul></ul>",1);function Xs(r,e){const[t,s]=Dt(),i=()=>It(ce(n),"$KVDemoPage",t),n=Ee(()=>e.data.KVDemoPage),a=Ee(i),l=Ee(()=>{var o;return((o=ce(a).data)==null?void 0:o.KVNames)??[]});var f=zs(),c=Ht(Qt(f),4);Zt(c,21,()=>ce(l),Yt,(o,d)=>{var u=js(),h=Wt(u,!0);tt(u),Jt(()=>Gt(h,ce(d))),Xe(o,u)}),tt(c),Xe(r,f),s()}export{he as A,Ae as D,Ys as _,ts as a,Se as b,ns as c,Oe as d,Fs as e,J as f,H as g,Ls as h,Xs as i,ut as k,Gs as l,nt as m};
